<% if !session[:user_id].nil? %>
  <%= form_tag posts_url, method: "get", :class=>"form", :role=>"form" do %>
    <div class="row">
    <div class="col-sm-10">
    <input type="text" class="form-control" placeholder="Post key word" name="search">
  </div>
  <div class="col-sm-2", align ="right" >
    <%= submit_tag "Search", :class=>"btn btn-success"%>
  </div>
  </div>
  <% end %>
<% end %>
  <br>
  <table class="table">
    <thead>
      <tr>
        <th>Post Title</th>
        <th>Poster</th>
        <th>Time</th>
        <th><small>Comments</small></th>
      </tr>
    </thead>
    <tbody>
      <% if !@posts.nil? %>
        <% @posts.each do |post| %>
          <tr>
            <td><%= link_to post.title, post_url(post.id) %></td>
            <td><%= link_to User.find_by_id(post.poster_id).user_name, user_url(post.poster_id) %></td>
            <td><%= post.date %></td>
            <td><%= Comment.where(post_id: post.id).count %></td>
            <td><% if Like.where(user_id: session[:user_id]).pluck(:post_id).include? post.id %>
                <%= form_tag  like_url(post.id), method: "delete", :class => "form pull-right" do%>
              <input type="hidden" name="url" value=<%= request.url %>>
              <%= submit_tag "Unlike", :class=>"btn btn-sm btn-danger pull-right"%>
            <% end %> 
          <% else %>
                <%= form_tag  like_url(post.id), method: "post", :class => "form pull-right" do%>
              <input type="hidden" name="url" value=<%= request.url %>>
              <%= submit_tag "Like", :class=>"btn btn-sm btn-primary pull-right"%>
            <% end %>  
          <% end %>
            </td>
          </tr>
      <% end %>
    </tbody>
  </table>
<% end %>